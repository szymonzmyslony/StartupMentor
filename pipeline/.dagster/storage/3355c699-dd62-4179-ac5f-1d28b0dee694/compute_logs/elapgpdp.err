[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - LOGS_CAPTURED - Started capturing logs in process (pid: 18601).
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - STEP_START - Started execution of step "docs_for_embeddings".
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - docs_for_embeddings - Loading file from: /Users/szymonzmyslony/projects/master-pipeline/pipeline/.dagster/storage/combined_and_cleaned_docs using PickledObjectFilesystemIOManager...
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step docs_for_embeddings
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - LOADED_INPUT - Loaded input "combined_and_cleaned_docs" using input manager "io_manager"
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - docs_for_embeddings - Loading file from: /Users/szymonzmyslony/projects/master-pipeline/pipeline/.dagster/storage/combined_and_cleaned_video_docs using PickledObjectFilesystemIOManager...
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step docs_for_embeddings
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - LOADED_INPUT - Loaded input "combined_and_cleaned_video_docs" using input manager "io_manager"
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - STEP_INPUT - Got input "combined_and_cleaned_docs" of type "Any". (Type check passed).
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - STEP_INPUT - Got input "combined_and_cleaned_video_docs" of type "Any". (Type check passed).
Exception while writing logger call to event log: Unhandled value type <class 'numpy.float64'>
[32m2024-02-04 21:54:18 +0100[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 3355c699-dd62-4179-ac5f-1d28b0dee694 - 18601 - docs_for_embeddings - STEP_FAILURE - Execution of step "docs_for_embeddings" failed.

dagster._serdes.errors.SerializationError: Unhandled value type <class 'numpy.float64'>

Stack Trace:
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_plan.py", line 286, in dagster_event_sequence_for_step
    for step_event in check.generator(step_events):
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 494, in core_dagster_event_sequence_for_step
    for evt in _type_check_and_store_output(step_context, user_event):
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 542, in _type_check_and_store_output
    for output_event in _type_check_output(step_context, step_output_handle, output, version):
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 398, in _type_check_output
    yield DagsterEvent.step_output_event(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/events/__init__.py", line 832, in step_output_event
    return DagsterEvent.from_step(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/events/__init__.py", line 431, in from_step
    log_step_event(step_context, event)
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/events/__init__.py", line 310, in log_step_event
    step_context.log.log_dagster_event(
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/log_manager.py", line 418, in log_dagster_event
    self.log(level=level, msg=msg, extra={DAGSTER_META_KEY: dagster_event})
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/log_manager.py", line 433, in log
    self._log(level, msg, args, **kwargs)
  File "/nix/store/03q8gn91mj95y5bqbcl90hyvmpqpz738-python3-3.11.7/lib/python3.11/logging/__init__.py", line 1634, in _log
    self.handle(record)
  File "/nix/store/03q8gn91mj95y5bqbcl90hyvmpqpz738-python3-3.11.7/lib/python3.11/logging/__init__.py", line 1644, in handle
    self.callHandlers(record)
  File "/nix/store/03q8gn91mj95y5bqbcl90hyvmpqpz738-python3-3.11.7/lib/python3.11/logging/__init__.py", line 1706, in callHandlers
    hdlr.handle(record)
  File "/nix/store/03q8gn91mj95y5bqbcl90hyvmpqpz738-python3-3.11.7/lib/python3.11/logging/__init__.py", line 978, in handle
    self.emit(record)
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/log_manager.py", line 299, in emit
    handler.handle(dagster_record)
  File "/nix/store/03q8gn91mj95y5bqbcl90hyvmpqpz738-python3-3.11.7/lib/python3.11/logging/__init__.py", line 978, in handle
    self.emit(record)
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/instance/__init__.py", line 236, in emit
    self._instance.handle_new_event(event)
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/instance/__init__.py", line 2315, in handle_new_event
    self._event_storage.store_event(event)
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/storage/event_log/sqlite/sqlite_event_log.py", line 239, in store_event
    insert_event_statement = self.prepare_insert_event(event)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/storage/event_log/sql_event_log.py", line 208, in prepare_insert_event
    event=serialize_value(event),
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 743, in serialize_value
    packed_value = pack_value(val, whitelist_map=whitelist_map)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 796, in pack_value
    return _pack_value(val, whitelist_map=whitelist_map, descent_path=descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 850, in _pack_value
    return serializer.pack(val, whitelist_map, descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 617, in pack
    packed[storage_key] = _pack_value(
                          ^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 850, in _pack_value
    return serializer.pack(val, whitelist_map, descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 617, in pack
    packed[storage_key] = _pack_value(
                          ^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 850, in _pack_value
    return serializer.pack(val, whitelist_map, descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 611, in pack
    packed[storage_key] = custom.pack(
                          ^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/definitions/metadata/__init__.py", line 1025, in pack
    return [
           ^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/definitions/metadata/__init__.py", line 1031, in <listcomp>
    "entry_data": pack_value(v, whitelist_map, descent_path),  # type: ignore
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 796, in pack_value
    return _pack_value(val, whitelist_map=whitelist_map, descent_path=descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 850, in _pack_value
    return serializer.pack(val, whitelist_map, descent_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 617, in pack
    packed[storage_key] = _pack_value(
                          ^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_serdes/serdes.py", line 883, in _pack_value
    raise SerializationError(f"Unhandled value type {tval}")
[0m
