[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - LOGS_CAPTURED - Started capturing logs in process (pid: 37943).
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - combined_and_cleaned_video_docs - STEP_START - Started execution of step "combined_and_cleaned_video_docs".
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Loading file from: /Users/szymonzmyslony/projects/master-pipeline/pipeline/.dagster/storage/complete_video_content using PickledObjectFilesystemIOManager...
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - combined_and_cleaned_video_docs - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step combined_and_cleaned_video_docs
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - combined_and_cleaned_video_docs - LOADED_INPUT - Loaded input "complete_video_content" using input manager "io_manager"
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - combined_and_cleaned_video_docs - STEP_INPUT - Got input "complete_video_content" of type "Any". (Type check passed).
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/GV-should-you-start-a-startup
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on double
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 26
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paragraph at index 20 exceeds the max length of 2048 characters. Truncating.
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: Should you start a startup?\n\nDescription: YC Group Partner Harj Taggar shares his advice on the types of people best suited to be startup founders and how to prepare to start a company in the future.\n\nChunk 1/26: Hey everyone. I'm Harj Taggar, one of the group partners at Y Combinator. Today I'm gonna talk about whether you should start a startup. ", "Title: Should you start a startup?\n\nDescription: YC Group Partner Harj Taggar shares his advice on the types of people best suited to be startup founders and how to prepare to start a company in the future.\n\nChunk 2/26: \nBecause YC invests in startups so early, I've spent a lot of time with people who aren't yet sure if they should start a company or not. I've helped many people, including my own friends and family, think about this decision and my intended audience for this talk is anyone who doesn't feel ready to start a startup today, but thinks they may want to one day in the future."]
[32m2024-02-01 17:33:30 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 26 paragraphs
[32m2024-02-01 17:33:31 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/6q-how-to-pitch-your-startup
[32m2024-02-01 17:33:31 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on double
[32m2024-02-01 17:33:31 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 90
[32m2024-02-01 17:33:31 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: How to Pitch Your Startup\n\nDescription: In this lecture, YC Partner Kevin Hale goes over how to package up your idea and communicate it to an investor. He shares his tips on how to craft your pitch in a clear and concise way that effectively grabs your audience's attention.\n\nChunk 1/90: Kevin: This is gonna be part two of a talk I gave at the very beginning of Startup School on evaluating startup ideas. And the thing to know about both of these talks is we've been talking about them from the point of view of the investor. Basically, it was helpful, I thought, to explain to founders how investors evaluate startup ideas and looking at that structure so that they can better understand their own ideas, opportunities, and then in this presentation, present them better to the people that they want to get excited.", "Title: How to Pitch Your Startup\n\nDescription: In this lecture, YC Partner Kevin Hale goes over how to package up your idea and communicate it to an investor. He shares his tips on how to craft your pitch in a clear and concise way that effectively grabs your audience's attention.\n\nChunk 2/90: \nSo, a quick recap. In the first part, I basically say a startup idea is a hypothesis for why your company is gonna grow really quickly. That hypothesis must compose of three different parts: the problem, the solution, and insight. And the basic parts is your problem should be pretty big, pretty pervasive, have a lot of these characteristics to make it feel like there's a very big market that a lot people have the problem. Don't think you need to know about the solution is that you should not start with a technology, you should start with a problem. And lastly, you're looking to have something that's gonna make your company unique and have some kind of unfair advantage that we call an insight that will show why your company will grow faster than other companies."]
[32m2024-02-01 17:33:31 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 90 paragraphs
[32m2024-02-01 17:33:32 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/J0-inside-the-group-partner-lounge-when-to-launch-your-startup
[32m2024-02-01 17:33:32 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on single
[32m2024-02-01 17:33:32 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 388
[32m2024-02-01 17:33:32 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: Inside the Group Partner Lounge: When to launch your startup\n\nDescription: Step inside the group partners' lounge to hear Y Combinator Partners Harj Taggar, Michael Seibel and Brad Flora discuss how startups should approach launching and the exceptions to the rules.\n\nChunk 1/388: i think this is image founders have of", "Title: Inside the Group Partner Lounge: When to launch your startup\n\nDescription: Step inside the group partners' lounge to hear Y Combinator Partners Harj Taggar, Michael Seibel and Brad Flora discuss how startups should approach launching and the exceptions to the rules.\n\nChunk 2/388: the launch which is it's going to be"]
[32m2024-02-01 17:33:32 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 388 paragraphs
[32m2024-02-01 17:33:34 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/Jq-garry-s-channel-should-you-be-the-ceo
[32m2024-02-01 17:33:34 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on single
[32m2024-02-01 17:33:34 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 230
[32m2024-02-01 17:33:34 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: Garry's Channel: Should you be the CEO?\n\nDescription: We were pitching A16z, with Marc Andreessen and Ben Horowitz. They asked us who was CEO. We said both. It was the wrong answer.\n\nChunk 1/230: Picture this, it's 2010,", "Title: Garry's Channel: Should you be the CEO?\n\nDescription: We were pitching A16z, with Marc Andreessen and Ben Horowitz. They asked us who was CEO. We said both. It was the wrong answer.\n\nChunk 2/230: and me and my co-founder"]
[32m2024-02-01 17:33:34 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 230 paragraphs
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/8h-how-to-find-the-right-co-founder
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on double
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 32
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: How to find the right co-founder\n\nDescription: YC's Harj Taggar shares advice on how to find the right co-founder for your startup.\n\nChunk 1/32: Hi, I'm Harj Taggar, and I'm partner at Y Combinator. And today I'm going to be talking about what I think is arguably the most important part of starting a company, which is finding the right co-founder.", "Title: How to find the right co-founder\n\nDescription: YC's Harj Taggar shares advice on how to find the right co-founder for your startup.\n\nChunk 2/32: \nSo let's start by talking about why should you have a co-founder at all. Well, I think there's three main reasons you really want a co-founder when you're starting a company. The first is productivity, you can get a lot more work done if you have someone to divide the work up with. And you can get much better work done if you have a co-founder who maybe has complementary skills, so they can do things that you can't. And there's someone you enjoy discussing ideas with. So you can brainstorm and come up with better ideas than you could alone, or have someone to talk you out of potentially bad ideas. So you get a lot of uplift in just the amount and quality of work you can do with a co-founder."]
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 32 paragraphs
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/8H-analytics-for-startups
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on single
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 600
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ["Title: Analytics for startups \n\nDescription: Ilya Volodarsky, co-founder of Segment, presents his tactics for setting up analytics to build your MVP and measure your metrics.\n\nChunk 1/600: hi everyone my name is Ilya I'm one of", "Title: Analytics for startups \n\nDescription: Ilya Volodarsky, co-founder of Segment, presents his tactics for setting up analytics to build your MVP and measure your metrics.\n\nChunk 2/600: the co-founders at segment and I'm here"]
[32m2024-02-01 17:33:36 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 600 paragraphs
[32m2024-02-01 17:33:38 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/DY-dalton-michael-yc-founders-made-these-fundraising-mistakes
[32m2024-02-01 17:33:38 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on single
[32m2024-02-01 17:33:38 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 223
[32m2024-02-01 17:33:38 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ['Title: Dalton & Michael: YC founders made these fundraising mistakes\n\nDescription: Dalton and Michael talk about fundraising mistakes. Learn how you can best build leverage as you set out to raise money, with examples from Airbnb, Google and Facebook.\n\nChunk 1/223: if you look at why the google founders', 'Title: Dalton & Michael: YC founders made these fundraising mistakes\n\nDescription: Dalton and Michael talk about fundraising mistakes. Learn how you can best build leverage as you set out to raise money, with examples from Airbnb, Google and Facebook.\n\nChunk 2/223: are the google founders and still have']
[32m2024-02-01 17:33:38 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 223 paragraphs
[32m2024-02-01 17:33:40 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - https://www.ycombinator.com/library/AQ-how-to-pick-which-startup-to-work-at
[32m2024-02-01 17:33:40 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Spitting on single
[32m2024-02-01 17:33:40 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - Paargraphs, 2714
[32m2024-02-01 17:33:40 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - ['Title: How to pick which startup to work at\n\nDescription: YC alum Justin Kan and former YC President Sam Altman talk about why you should or should not work at a startup, and what being an employee at one entails.\n\nChunk 1/2714: okay hello everyone and welcome to work', 'Title: How to pick which startup to work at\n\nDescription: YC alum Justin Kan and former YC President Sam Altman talk about why you should or should not work at a startup, and what being an employee at one entails.\n\nChunk 2/2714: at a startup this is the first time']
[32m2024-02-01 17:33:40 +0100[0m - dagster - [34mINFO[0m - __ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - combined_and_cleaned_video_docs - We have 2714 paragraphs
[32m2024-02-01 17:33:41 +0100[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - d984b84e-470b-40ce-90da-526da37e0357 - 37943 - combined_and_cleaned_video_docs - STEP_FAILURE - Execution of step "combined_and_cleaned_video_docs" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "combined_and_cleaned_video_docs"::

openai.BadRequestError: Error code: 400 - {'error': {'message': "'$.input' is invalid. Please check the API reference: https://platform.openai.com/docs/api-reference.", 'type': 'invalid_request_error', 'param': None, 'code': None}}

Stack Trace:
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 467, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 131, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 125, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/pipeline/assets.py", line 275, in combined_and_cleaned_video_docs
    cleaned_documents = [
                        ^
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/pipeline/assets.py", line 280, in <listcomp>
    chunk_document(video)
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/pipeline/assets.py", line 270, in chunk_document
    transript_chunks, _ = transcript_chunker.chunk_document()
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/chunker/DocumentChunker.py", line 135, in chunk_document
    self.embed_paragraphs()
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/chunker/DocumentChunker.py", line 106, in embed_paragraphs
    x.embedding for x in get_embedding(valid_paragraphs_with_context)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/projects/master-pipeline/pipeline/chunker/embeddings.py", line 15, in get_embedding
    response = client.embeddings.create(input=text, model=model)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/openai/resources/embeddings.py", line 113, in create
    return self._post(
           ^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1180, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 869, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 960, in _request
    raise self._make_status_error_from_response(err.response) from None

The above exception occurred during handling of the following exception:
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.openai.com/v1/embeddings'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

Stack Trace:
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 939, in _request
    response.raise_for_status()
  File "/Users/szymonzmyslony/Library/Caches/pypoetry/virtualenvs/pipeline-RtkjAAJa-py3.11/lib/python3.11/site-packages/httpx/_models.py", line 759, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
[0m
